import pyproj
import numpy as np

subways_loc = pd.read_csv('subways_loc.csv')

#Have to set the projections in order to transform them. Used http://www.spatialreference.org/ref/?search=new+york to figure them out.

NAD83_LI = pyproj.Proj(init = "EPSG:3627", preserve_units=True)
NYS_LIZ = pyproj.Proj(init = "EPSG:2263", preserve_units=True)

#Defining the function to transform all the values.

def coord_transform(df):
    x = pd.Series()
    y = pd.Series()
    for idx, val in enumerate(df['Latitude']):
    #Yes it sounds odd that longitude comes before latitude in the transform, but it is the correct syntax.
        x1, y1 = pyproj.transform(NAD83_LI, NYS_LIZ, df['Longitude'][idx], df['Latitude'][idx])
        x.set_value(idx, x1)
        y.set_value(idx, y1)
    df['x'] = x
    df['y'] = y
    return df
    
subways_loc_trans = coord_transform(subways_loc)

print(subways_loc_trans.head(1))
